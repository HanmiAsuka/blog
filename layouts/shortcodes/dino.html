<div class="switch-wrapper">
  <!-- ä½ çš„ Switch HTML ç»“æ„ (joy-con, screen ç­‰) ä¿æŒä¸å˜ï¼Œä¸ºäº†ç¯‡å¹…æˆ‘æŠ˜å äº†ï¼Œè¯·ä¿ç•™åŸæ · -->
  <div class="switch-console">
    <div class="joy-con left">
      <div class="switch-btn-group d-pad"><div class="switch-btn up"></div><div class="switch-btn right"></div><div class="switch-btn down"></div><div class="switch-btn left"></div></div>
      <div class="stick"></div><div class="switch-btn minus">-</div><div class="switch-btn capture"></div>
    </div>
    <div class="console-screen">
      <div class="screen-bezel">
        <div id="dino-wrapper">
          <div id="dino-cover">
            <div class="dino-emoji">ğŸ¦–</div>
            <p class="dino-text">PRESS START</p>
          </div>
          <!-- ç¡®ä¿ data-src æ­£ç¡® -->
          <iframe id="dino-frame" data-src="/blog/dino/index.html" frameborder="0" scrolling="no"></iframe>
        </div>
      </div>
    </div>
    <div class="joy-con right">
      <div class="switch-btn plus">+</div>
      <div class="switch-btn-group abxy"><div class="switch-btn a"></div><div class="switch-btn b"></div><div class="switch-btn x"></div><div class="switch-btn y"></div></div>
      <div class="stick"></div><div class="switch-btn switch-home-btn"></div>
    </div>
  </div>
</div>

<style>
/* è¿™é‡Œä¿ç•™ä½ åŸæœ¬çš„æ‰€æœ‰ CSS æ ·å¼ï¼Œä¸éœ€è¦ä¿®æ”¹ */
/* ... existing styles ... */
  .switch-wrapper { display: flex; justify-content: center; align-items: center; width: 100%; margin: 2rem 0; overflow: visible; }
  .switch-console { display: flex; justify-content: center; align-items: center; padding: 10px; width: fit-content; user-select: none; -webkit-user-select: none; cursor: pointer; touch-action: manipulation; transform-origin: center center; transform: translateZ(0); transform: scale(0.9); margin: -15px 0; }
  @media (max-width: 900px) { .switch-console { transform: scale(0.75); margin: -35px 0; } }
  @media (max-width: 600px) { .switch-console { transform: scale(0.55); margin: -65px 0; } }
  @media (max-width: 380px) { .switch-console { transform: scale(0.45); margin: -80px -10%; } }
  .joy-con { width: 90px; height: 240px; background: #333; position: relative; flex-shrink: 0; box-shadow: inset -5px 0 10px rgba(0,0,0,0.2); }
  .joy-con.left { background-color: #00c3e3; border-top-left-radius: 50px; border-bottom-left-radius: 50px; border-right: 1px solid rgba(0,0,0,0.1); box-shadow: inset 5px 5px 10px rgba(255,255,255,0.2); }
  .joy-con.right { background-color: #ff4554; border-top-right-radius: 50px; border-bottom-right-radius: 50px; border-left: 1px solid rgba(0,0,0,0.1); box-shadow: inset 5px 5px 10px rgba(255,255,255,0.2); }
  .console-screen { background: #111; padding: 15px 5px; border-radius: 4px; box-shadow: 0 0 0 2px #222; z-index: 10; }
  .screen-bezel { width: 460px; height: 210px; background: #000; overflow: hidden; position: relative; border: 1px solid #333; }
  #dino-wrapper { width: 100%; height: 100%; position: relative; background-color: #f7f7f7; }
  #dino-cover { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 20; display: flex; flex-direction: column; align-items: center; justify-content: center; background-color: #222; color: #fff; transition: opacity 0.4s ease, visibility 0.4s; }
  #dino-frame { width: 100%; height: 100%; position: relative; z-index: 1; display: block; touch-action: auto; }
  .stick { width: 36px; height: 36px; background: #222; border-radius: 50%; position: absolute; left: 50%; transform: translateX(-50%); box-shadow: 0 2px 4px rgba(0,0,0,0.6); border: 2px solid #111; }
  .left .stick { top: 40px; } .right .stick { bottom: 90px; }
  .switch-btn-group { position: absolute; left: 50%; transform: translateX(-50%); width: 60px; height: 60px; }
  .left .d-pad { bottom: 80px; } .right .abxy { top: 30px; }
  .switch-btn { position: absolute; background: #222; border-radius: 50%; box-shadow: 0 1px 2px rgba(0,0,0,0.5); }
  .abxy .switch-btn { width: 18px; height: 18px; }
  .abxy .switch-btn.a { right: 0; top: 21px; } .abxy .switch-btn.b { bottom: 0; left: 21px; } .abxy .switch-btn.x { top: 0; left: 21px; } .abxy .switch-btn.y { left: 0; top: 21px; }
  .d-pad .switch-btn { width: 18px; height: 18px; }
  .d-pad .switch-btn.up { top: 0; left: 21px; } .d-pad .switch-btn.down { bottom: 0; left: 21px; } .d-pad .switch-btn.left { left: 0; top: 21px; } .d-pad .switch-btn.right { right: 0; top: 21px; }
  .minus, .plus { width: 16px; height: 4px; background: #333; top: 15px; color: #333; font-size: 0; border-radius: 2px; }
  .minus { right: 15px; position: absolute; } .plus { left: 15px; position: absolute; }
  .plus::after { content: ''; position: absolute; width: 4px; height: 16px; background: #333; left: 6px; top: -6px; border-radius: 2px; }
  .switch-home-btn { bottom: 55px; right: 55px; width: 20px; height: 20px; border-radius: 50%; background: #222; }
  .capture { bottom: 50px; right: 15px; width: 20px; height: 20px; background: #222; border-radius: 4px; }
  .dino-emoji { font-size: 3rem; animation: jump 0.8s infinite alternate; }
  .dino-text { margin-top: 10px; font-family: 'Arial', sans-serif; font-size: 0.8rem; letter-spacing: 2px; color: #00c3e3; animation: blink 1s infinite; }
  @keyframes jump { from { transform: translateY(0); } to { transform: translateY(-8px); } }
  @keyframes blink { 50% { opacity: 0; } }
</style>

<script>
  (function() {
    var consoleBody = document.querySelector('.switch-console');
    var cover = document.getElementById('dino-cover');
    var frame = document.getElementById('dino-frame');
    var isActivated = false;
    
    // å…³æœºé€»è¾‘
    function turnOff() {
      if (!isActivated) return;
      isActivated = false;
      console.log("Switch: Power OFF"); // è°ƒè¯•ç”¨
      
      // æ´¾å‘äº‹ä»¶ï¼Œé€šçŸ¥çŒ«çŒ«æ•£å¼€
      window.dispatchEvent(new CustomEvent('switch-game-end'));

      cover.style.opacity = '1';
      cover.style.visibility = 'visible';
      cover.style.pointerEvents = 'auto';

      // é‡ç½® iframe æ¸¸æˆ
      var currentSrc = frame.src;
      frame.src = 'about:blank'; 
      setTimeout(function(){ frame.src = currentSrc; }, 50);
    }

    // å¼€æœºé€»è¾‘
    function turnOn() {
      if (isActivated) return;
      isActivated = true;
      console.log("Switch: Power ON");
      
      window.dispatchEvent(new CustomEvent('switch-game-start'));
      
      cover.style.opacity = '0';
      cover.style.visibility = 'hidden';
      cover.style.pointerEvents = 'none';

      var gameUrl = frame.getAttribute('data-src');
      if (gameUrl && (frame.src === "" || frame.src === "about:blank" || frame.src === window.location.href)) {
        frame.src = gameUrl;
      }
      setTimeout(function() { 
        if(frame.contentWindow) frame.contentWindow.focus(); 
      }, 100);
    }

    if (consoleBody && cover) {
      // 1. ç‚¹å‡» Switch å†…éƒ¨ï¼šå¼€æœº
      consoleBody.addEventListener('click', function(e) {
        e.stopPropagation(); // å…³é”®ï¼šé˜²æ­¢å†’æ³¡è§¦å‘ä¸‹æ–¹çš„ document click
        turnOn();
      });

      // 2. ç‚¹å‡» Switch å¤–éƒ¨ï¼šå…³æœº
      // ä½¿ç”¨ capture: true ç¡®ä¿å°½æ—©æ•è·ï¼Œä½†è¿™é‡Œæˆ‘ä»¬ç”¨æ™®é€šå†’æ³¡ç›‘å¬ document å³å¯
      document.addEventListener('click', function(e) {
        if (isActivated) {
          // æ£€æŸ¥ç‚¹å‡»ç›®æ ‡æ˜¯å¦åœ¨ switch console å†…éƒ¨
          if (!consoleBody.contains(e.target)) {
            turnOff();
          }
        }
      });
    }
  })();
</script>